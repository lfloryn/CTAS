[![Home](/img/home.jpg)](Readme.md)


# Detect, remove, and prevent malware using appropriate tools and methods.
### Index 

Over time, best practices have been developed through trial and error that help minimize
the chances of getting viruses and reduce the effort involved in getting rid of malware.
Some of these practices are discussed in this section. The topics covered in this section
include the following:

- [**Malware**](#Malware)
- [**Tools and methods**](#Tools_and_methods)

# Malware
Malware is a category of software that performs malicious activities on a device. It might
wipe the hard drive or create a back door. In this section, we'll look at types of malware
and attacks.

# Ransomware
Ransomware is a type of malware that usually encrypts the entire system or an entire drive
with an encryption key that only the hacker possesses. Once she encrypts the machine, she
will hold the data residing on the device hostage until a ransom is paid.

The latest version of this attack arrives as an attachment that appears to be a resume.
However, when the attachment is opened, the malware uses software called Cryptowall to
encrypt the device. What usually follows is a demand for $500 to decrypt the device.

CryptoLocker

![mal](/img/f2.4_Sec_malware_6.jpg)


# Trojan
Trojan horses are programs that enter a system or network under the guise of another
program. A Trojan horse may be included as an attachment or as part of an installation
program. 

The Trojan horse can create a back door or replace a valid program during installation.
It then accomplishes its mission under the guise of another program. Trojan horses
can be used to compromise the security of your system, and they can exist on a system for
years before they're detected.

The best preventive measure for Trojan horses is not to allow them entry into your system.
Immediately before and after you install a new software program or operating system,
back it up! If you suspect a Trojan horse, you can reinstall the original programs, which
should delete the Trojan horse. 

A port scan may also reveal a Trojan horse on your system.
If an application opens a TCP or IP port that isn't supported in your network, you can
track it down and determine which port is being used.

# Keylogger
A keylogger records everything typed and sends a record of this to the attacker. It can be
implemented as a malicious software package, maybe even as part of a rootkit; or it may be
a hardware device inserted between the keyboard and the USB port.

# Rootkit
Rootkits have become the software exploitation program du jour. They are software programs
that have the ability to hide certain things from the operating system. With a rootkit, there
may be a number of processes running on a system that don't show up in Task Manager, or
connections may be established/available that don't appear in a Netstat display—the rootkit
masks the presence of these items. The rootkit does this by manipulating function calls to the
operating system and fi ltering out information that would normally appear.

Unfortunately, many rootkits are written to get around antivirus and antispyware programs
that aren't kept up-to-date. The best defense you have is to monitor what your system
is doing and catch the rootkit in the process of installation.

# Virus
Viruses can be classifi ed as polymorphic, stealth, retroviruses, multipartite, armored, companion,
phage, and macro viruses. Each type of virus has a different attack strategy and
different consequences.

The following sections will introduce the symptoms of a virus infection, explain how a
virus works, and describe the types of viruses you can expect to encounter and how they
generally behave. I'll also discuss how a virus is transmitted through a network.

![note](/img/note.jpg) Estimates for losses due to viruses are in the billions of dollars. These
losses include financial loss as well as lost productivity.

# Symptoms of a virus/malware infection
Many viruses will announce that you're infected as soon as they gain access to your system.
They may take control of your system and fl ash annoying messages on your screen or
destroy your hard disk. When this occurs, you'll know that you're a victim. Other viruses
will cause your system to slow down, cause fi les to disappear from your computer, or take
over your disk space.

![note](/img/note.jpg) Because viruses are the most common malware, the term virus is used in this section.


You should look for some of the following symptoms when determining whether a virus
infection has occurred:

-  The programs on your system start to load more slowly. This happens because the virus is spreading to other files in your system or is taking over system resources.
-  Unusual files appear on your hard drive, or files start to disappear from your system. Many viruses delete key files in your system to render it inoperable.
-  Program sizes change from the installed versions. This occurs because the virus is attaching itself to these programs on your disk.
-  Your browser, word-processing application, or other software begins to exhibit unusual operating characteristics. Screens or menus may change.
-  The system mysteriously shuts itself down or starts itself up and does a great deal of unanticipated disk activity.
-  You mysteriously lose access to a disk drive or other system resources. The virus has changed the settings on a device to make it unusable.
-  Your system suddenly doesn't reboot or gives unexpected error messages during startup. This list is by no means comprehensive. What is an absolute, however, is that you should immediately quarantine the infected system. It is imperative that you do all you can to contain
the virus and keep it from spreading to other systems within your network or beyond.

# How viruses work
A virus, in most cases, tries to accomplish one of two things: render your system inoperable
or spread itself to other systems. Many viruses will spread to other systems given
the chance and then render your system unusable. This is common with many of the
newer viruses.

If your system is infected, the virus may try to attach itself to every fi le in your system and
spread each time you send a fi le or document to other users. When you give removable media
to another user or put it into another system, you then infect that system with the virus.

Most viruses today are spread using email. The infected system attaches a fi le to any
email that you send to another user. The recipient opens this fi le, thinking it's something
you legitimately sent them. When they open the fi le, the virus infects the target system.

The virus might then attach itself to all the emails the newly infected system sends, which
in turn infects the recipients of the emails. Figure shows how a virus can spread from a
single user to thousands of users in a short time using email.

![mal](/img/f2.4_Sec_malware_1.jpg)

# Types of viruses
Viruses take many different forms. The following sections briefl y introduce these forms
and explain how they work. These are the most common types, but this isn't a comprehensive
list.

![note](/img/note.jpg) The best defense against a virus attack is to install and run antivirus software.
The software should be on all workstations as well as the server.

**Armored Virus**An armored virus is designed to make itself difficult to detect or analyze. 
Armored viruses cover themselves with protective code that stops debuggers or disassemblers
from examining critical elements of the virus. The virus may be written in such a way
that some aspects of the programming act as a decoy to distract analysis while the actual
code hides in other areas in the program.

From the perspective of the creator, the more time it takes to deconstruct the virus, the longer it
can live. The longer it can live, the more time it has to replicate and spread to as many machines
as possible. The key to stopping most viruses is to identify them quickly and educate administrators
about them—the very things that the armor intensifies the difficulty of accomplishing.

**Companion Virus** A companion virus attaches itself to legitimate programs and then
creates a program with a different filename extension. 

This file may reside in your system's
temporary directory. When a user types the name of the legitimate program, the
companion virus executes instead of the real program. This effectively hides the virus from
the user. Many of the viruses that are used to attack Windows systems make changes to
program pointers in the Registry so that they point to the infected program. The infected
program may perform its dirty deed and then start the real program.

**Macro Virus** A macro virus exploits the enhancements made to many application programs.
Programmers can expand the capability of applications such as Microsoft Word and
Excel.

 Word, for example, supports a mini-BASIC programming language that allows files
to be manipulated automatically. These programs in the document are called macros. For
example, a macro can tell your word processor to spell-check your document automatically
when it opens. Macro viruses can infect all the documents on your system and spread to
other systems via email or other methods.

**Multipartite Virus**  A multipartite virus attacks your system in multiple ways. It may
attempt to infect your boot sector, infect all your executable files, and destroy your application
files. The hope here is that you won't be able to correct all the problems and will allow
the infestation to continue. The multipartite virus in Figure attacks your boot sector,
infects application files, and attacks your Word documents.

![mal](/img/f2.4_Sec_malware_2.jpg)

**Phage Virus** A phage virus alters other programs and databases. The virus infects all
these files. The only way to remove this virus is to reinstall the programs that are infected.
If you miss even a single instance of this virus on the victim system, the process will start
again and infect the system once more.

**Polymorphic Virus** Polymorphic viruses change form in order to avoid detection. The
virus will attempt to hide from your antivirus software. Frequently, the virus will encrypt
parts of itself to avoid detection. When the virus does this, it's referred to as mutation . The
mutation process makes it hard for antivirus software to detect common characteristics of
the virus. Figure 7.6 shows a polymorphic virus changing its characteristics to avoid detection.
In this example, the virus changes a signature to fool antivirus software.

The polymorphic virus changing its characteristics

![mal](/img/f2.4_Sec_malware_3.jpg)

![note](/img/note.jpg)  A signature is an algorithm or other element of a virus that uniquely identifies
it. Because some viruses have the ability to alter their signature,
it is crucial that you keep signature files current, whether you choose
to manually download them or configure the antivirus engine to do so
automatically.

**Retrovirus** A retrovirus attacks or bypasses the antivirus software installed on a computer.
You can consider a retrovirus to be an anti-antivirus. Retroviruses can directly attack your
antivirus software and potentially destroy the virus defi nition database fi le. Destroying this
information without your knowledge would leave you with a false sense of security. The
virus may also directly attack an antivirus program to create bypasses for itself.

**Stealth Virus** A stealth virus attempts to avoid detection by masking itself from applications.
It may attach itself to the boot sector of the hard drive. When a system utility
or program runs, the stealth virus redirects commands around itself to avoid detection.

An infected fi le may report a fi le size different from what is actually present to avoid
detection. Figure shows a stealth virus attaching itself to the boot sector to avoid
detection. Stealth viruses may also move themselves from file A to file B during a virus
scan for the same reason.

![mal](/img/f2.4_Sec_malware_4.jpg)

# Present Virus Activity
New viruses and threats are released on a regular basis to join the cadre of those already
in existence. From an exam perspective, you need to be familiar with the world only as it
existed at the time the questions were written. From an administrative standpoint, however,
you need to know what is happening today.

To find this information, visit the CERT/CC Current Activity web page at 

http://www.us-cert.gov/current/current_activity.html

Here you'll find a detailed description of the most current viruses as well as links to pages on older threats.

# Botnet
A bot is a type of malware that installs itself on large numbers of computers through
infected email, downloads from websites, Trojan horses, and shared media. Once installed,
the bot has the ability to connect back to the hacker's computer. After that, the hacker's
server controls all the bots located on these machines.

At a set time, the hacker may direct
the bots to take some action, such as to direct all the machines to send out spam messages,
mount a DoS attack, or perform phishing or any number of malicious acts. The collection
of computers that act together is called a botnet, and the individual computers are called
zombies. 

By recruiting many zombies to assist in the attack, the attacker greatly magnifies
its effect.

# Worm

A worm is different from a virus in that it can reproduce itself, it's self-contained, and it
doesn't need a host application to be transported. Many of the so-called viruses that have
made the news were actually worms. However, it's possible for a worm to contain or deliver
a virus to a target system.

By their nature and origin, worms are supposed to propagate, and they use whatever services
they're capable of to do that. Early worms filled up memory and bred inside the RAM
of the target computer. Worms can use TCP/IP, email, Internet services, social media sites,
or any number of possibilities to reach their target.

# Spyware
Spyware differs from other malware in that it works—often actively—on behalf of a third
party. Rather than self-replicating, like viruses and worms, spyware is spread to machines
by users who inadvertently ask for it. The users often don't know they have asked for the
spyware but have done so by downloading other programs, visiting infected sites, and so on.

The spyware program monitors the user's activity and responds by offering unsolicited
pop-up advertisements (sometimes known as adware), gathers information about the user
to pass on to marketers, or intercepts personal data such as credit card numbers.


[Top](#Index)

# Tools_and_methods

Whereas physical security focused on keeping individuals out, digital security focuses
mostly on keeping harmful data/malware out. The areas of focus are antivirus software,
anti-malware, Recovery Console, backup/restore, end-user education, software firewalls, and
DNS configuration. Each of these is addressed in the sections that follow.

# Antivirus/Anti-malware
The primary method of preventing the propagation of malicious code involves the use of
antivirus software. Antivirus and anti-malware are discussed.


Antivirus software components

![anti](/img/f2.4_Sec_malware_7.jpg)

Antivirus Engine The antivirus engine is responsible for the real-time scanning of operating
system files and the notifications to the user. Various antivirus engines will scan
operating system files differently. For example, an antivirus engine might recognize when a
game is being played, and it will temporarily stop scanning files so that the game loads faster.

Notifications can also automatically submit files to the cloud for more extensive scanning.

Definitions Database The definitions database is why you would select one antivirus
product over another. A definitions database's effectiveness is based on two attributes: the
frequency of updates and the comprehensiveness of the database signatures. Antivirus definitions,
also known as antivirus signatures, are discovered daily and added to the antivirus
database. Some antivirus products will download deltas to the initial database every hour,
and some will download them once a day.

## Anti-Malware

Malware is a broad term and covers many different software threats that we learned about
in this chapter. Anti-malware and antivirus are extremely similar in their functionality, and
sometimes vendors have a hard time differentiating their products. This is because many
antivirus products now check more than just files.

![anti](/img/f2.4_Sec_malware_8.jpg)



# Recovery Console
The Recovery Console isn't installed on a Windows system by default. To install it, follow
these steps:
1. Place the Windows disc in the system.
2. From a command prompt, change to the i386 directory of the CD.
3. Type winnt32 /cmdcons.
4. A prompt appears, alerting you to the fact that 7 MB of hard drive space is required and asking whether you want to continue. Click Yes.
Upon successful completion of the installation, the Recovery Console is added as a menu
choice at the bottom of the startup menu. 

To access it, you must choose it from the list
at startup. If more than one installation of Windows exists on the system, another boot
menu will appear, asking which you want to boot into, and you must make a selection to
continue.

To perform this task, you must give the administrator password. You'll then arrive at a
command prompt. You can give a number of commands from this prompt, two of which
are worth special attention: exit restarts the computer, and help lists the commands you
can give. Table explains some options.

Recovery Console options

![mal](/img/f2.4_Sec_malware_5.jpg)


Windows 10 Recovery Console

![mal](/img/f2.4_Sec_malware_9.jpg)

Windows 10 Advanced Options

![mal](/img/f2.4_Sec_malware_10.jpg)


# Backup/restore
Backups are duplicate copies of key information, ideally stored in a location other than the
one where the information is currently stored. Backups include both paper and computer
records. Computer records are usually backed up using a backup program, backup systems,
and backup procedures.

The primary starting point for disaster recovery involves keeping current backup copies
of key data files, databases, applications, and paper records available for use. Your organization
must develop a solid set of procedures to manage this process and ensure that all key
information is protected. A security professional can do several things in conjunction with
systems administrators and business managers to protect this information. It's important to
think of this problem as an issue that is larger than a single department.

The information you back up must be immediately available for use when needed. If a
user loses a critical file, they won't want to wait several days while data files are sent from a
remote storage facility. Several types of storage mechanisms are available for data storage.
Working Copies Working copy backups—sometimes referred to as shadow copies—are
partial or full backups that are kept on the premises for immediate recovery purposes.

Working copies are frequently the most recent backups that have been made.
Typically, working copies are intended for immediate use. These copies are often updated
on a frequent basis.

Many file systems used on servers include journaling. Journaled file systems (JFSs) include a
log file of all changes and transactions that have occurred within a set period of time (such
as the last few hours). If a crash occurs, the operating system can look at the log files to see
which transactions have been committed and which ones haven't. This technology works
well and allows unsaved data to be written after the recovery and the system (usually) to be
successfully restored to its condition before the crash.

**On-Site** Storage On-site storage usually refers to a location on the site of the computer
center that is used to store information locally. On-site storage containers are available that
allow computer cartridges, tapes, and other backup media to be stored in a reasonably protected
environment in the building.

On-site storage containers are designed and rated for fire, moisture, and pressure resistance.
These containers aren't fireproof in most situations, but they're fire-rated: A fireproof container
should be guaranteed to withstand damage regardless of the type of fire or temperatures,
whereas fire ratings specify that a container can protect the contents for a specific
amount of time in a given situation.

If you choose to depend entirely on on-site storage, make sure the containers you acquire
can withstand the worst-case environmental catastrophes that could happen at your location.
Make sure as well that those containers are in locations where you can easily find
them after the disaster and access them (near exterior walls, and so on).

**Off-Site** Storage Off-site storage refers to a location away from the computer center
where paper copies and backup media are kept. Off-site storage can involve something as
simple as keeping a copy of backup media at a remote office, or it can be as complicated
as a nuclear-hardened high-security storage facility. The storage facility should be bonded,
insured, and inspected on a regular basis to ensure that all storage procedures are being
followed.

Determining which storage mechanism to use should be based on the needs of the organization,
the availability of storage facilities, and the budget available. Most off-site storage
facilities charge based on the amount of space you require and the frequency of access you
need to the stored information.

Three methods exist to back up information on most systems.

**Full Backup** A full backup is a complete, comprehensive backup of all files on a disk or
server. The full backup is current only at the time it's performed. Once a full backup is
made, you have a complete archive of the system at that point in time. A system shouldn't
be in use while it undergoes a full backup because some files may not get backed up. Once
the system goes back into operation, the backup is no longer current. A full backup can be
a time-consuming process on a large system.

**Incremental Backup** An incremental backup is a partial backup that stores only the
information that has been changed since the last full or incremental backup. If a full
backup were performed on a Sunday night, an incremental backup done on Monday night
would contain only the information that changed since Sunday night. Such a backup is
typically considerably smaller than a full backup. This backup system requires that each
incremental backup be retained until a full backup can be performed. Incremental backups
are usually the fastest backups to perform on most systems, and each incremental tape is
relatively small.

**Differential Backup** A differential backup is similar in function to an incremental backup,
but it backs up any files that have been altered since the last full backup; it makes duplicate
copies of files that haven't changed since the last differential backup. If a full backup
was performed on Sunday night, a differential backup performed on Monday night would
capture the information that was changed on Monday. 

A differential backup completed on
Tuesday night would record the changes in any files from Monday and any changes in files
on Tuesday. As you can see, during the week each differential backup would become larger;
by Friday or Saturday night, it might be nearly as large as a full backup. This means the
backups in the earliest part of the weekly cycle will be very fast, and each successive one
will be slower.

When these backup methods are used in conjunction with each other, the risk of loss can
be greatly reduced. You should never combine an incremental backup with a differential
backup. One of the major factors in determining which combination of these three methods
to use is time—ideally, a full backup would be performed every day. Several commercial
backup programs support these three backup methods. You must evaluate your organizational
needs when choosing which tools to use to accomplish backups.

Almost every stable operating system contains a utility for creating a copy of configuration
settings necessary to reach the present state after a disaster. As an administrator, you
must know how to do backups and be familiar with all the options available to you.

Windows 10 Backup file history

![mal](/img/f2.4_Sec_malware_11.jpg)

Windows 10 Ransomware Protection

![mal](/img/f2.4_Sec_malware_12.jpg)

# End-user education
In many cases, users are partly responsible for a virus infection. After an infection occurs
is a great time to impress on users the principles of secure computing. They should be
reminded that antivirus software and firewalls can go only so far in protecting them and
that they should exercise safe browsing habits and refrain from opening any attachments in
email from unknown sources, regardless of how tempting.

# Software firewalls
You can add a second layer of defense by utilizing personal or software firewalls on devices.
This can be in addition to your network firewall and help prevent attacks locally on
machines. The Windows Firewall is a good example of such a software firewall.

Windows Defender Firewall on Windows 10

![mal](/img/f2.4_Sec_malware_13.jpg)

Windows Defender Firewall defaults

![mal](/img/f2.4_Sec_malware_14.jpg)


# DNS configuration
Domain Name System Security Extensions (DNSSEC) is a new version of DNS that provides
to DNS clients (resolvers) origin authentication of DNS data, authenticated denial of
existence, and data integrity, but not availability or confidentiality. It helps to prevent the
use of rogue DNS servers that lead users to malicious sites.



[Top](#Index)

